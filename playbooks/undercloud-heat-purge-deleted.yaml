---
- hosts: undercloud
  vars:
    metadata:
      name: Verify heat-manage purge_deleted is enabled in crontab
      description: |
        Without a purge_deleted crontab enabled, the
        heat database can grow very large. This validation checks that
        the purge_deleted crontab has been set up.
        This validation should only be used on systems using 'heat_api_cron'.
        Starting from Wallaby, the 'heat_api_cron' is no longer installed by
        default, and the role may behave upredictably.
      groups: []
      categories:
        - orchestration
        - os
        - system
        - cron
      products:
        - tripleo
    cron_check: "heat-manage purge_deleted"
  roles:
    - undercloud_heat_purge_deleted
