---
- project:
    templates:
      - tripleo-validations-molecule-jobs
      - release-notes-jobs-python3
      - check-requirements
    check:
      jobs:
        - openstack-tox-linters
        - openstack-tox-py38
        - openstack-tox-py39
        - tripleo-ci-centos-9-content-provider:
            irrelevant-files: &docs_only_files
              - ^.*\.rst$
              - ^doc/.*$
              - ^releasenotes/.*$
            dependencies:
              - openstack-tox-linters
              - openstack-tox-py38
              - openstack-tox-py39
        - tripleo-ci-centos-9-standalone-tv-validation:
            irrelevant-files: *docs_only_files
            vars: &consumer_vars
              consumer_job: true
              build_container_images: false
            dependencies:
              - tripleo-ci-centos-9-content-provider
        - tripleo-ci-centos-9-containers-multinode:
            irrelevant-files: *docs_only_files
            vars:
              <<: *consumer_vars
              enable_validation: true
              playbooks:
                - multinode.yml
              remove_tags:
                - build
              validations_inventory: ""
            dependencies:
              - tripleo-ci-centos-9-content-provider
        - openstack-tox-docs: &tripleo-docs
            files:
              - ^doc/.*
              - ^groups.yaml
              - ^molecule-requirements.txt
              - ^requirements.txt
              - ^README.rst
              - ^tripleo_validations/.*
              - ^roles/.*
              - ^playbooks/.*
              - ^library/.*
    gate:
      jobs:
        - openstack-tox-linters
        - openstack-tox-py38
        - openstack-tox-py39
        - tripleo-ci-centos-9-content-provider:
            irrelevant-files: *docs_only_files
            dependencies:
              - openstack-tox-linters
              - openstack-tox-py38
              - openstack-tox-py39
        - openstack-tox-docs: *tripleo-docs
        - tripleo-ci-centos-9-standalone-tv-validation:
            irrelevant-files: *docs_only_files
            vars: *consumer_vars
            dependencies:
              - tripleo-ci-centos-9-content-provider
        - tripleo-ci-centos-9-containers-multinode:
            irrelevant-files: *docs_only_files
            vars:
              <<: *consumer_vars
              enable_validation: true
              playbooks:
                - multinode.yml
              remove_tags:
                - build
            dependencies:
              - tripleo-ci-centos-9-content-provider

    promote:
      jobs:
        - promote-openstack-tox-docs: *tripleo-docs
